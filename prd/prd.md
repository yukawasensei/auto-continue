# V1.0版本

## 1. 项目概览

|  |  |
| --- | --- |
| **产品名称** | AutoContinue – 课程学习弹窗自动点击插件 |
| **版本** | v1.0 |
| **撰写日期** | 2025‑04‑09 |
| **作者** | Perry Huang |
| **目标发布日期** | 2025‑05‑15 |

## 2. 背景 & 机会

在线课程平台为了防止学员挂机，会在长时间无鼠标或键盘操作时弹出“仍在观看？”提示框，若用户未在限定时间内点击确认，则课程播放会暂停甚至强制退出。这一机制对认真学习者影响不大，但对需要长时间播放课程视频进行回顾或做笔记的用户造成中断，影响学习效率。

通过 Chrome 插件在检测到此类提示框后自动执行“确认”点击，可以：

- 保证课程播放连续性，避免手动干预。
- 提升学习专注度，减少被动中断。
- 为需要批量观看课程（如企业内训、刷课）场景提供效率工具。

## 3. 目标

1. **核心目标**：在检测到课程页面出现“活人检测”弹窗时，于 1 秒内自动完成点击确认操作。
2. **兼容性目标**：首版支持 3 个主流在线课程网站（可在 Beta 阶段配置域名白名单），并提供可视化规则编辑器以便用户自行适配其他站点。
3. **稳定性目标**：插件 24 小时运行崩溃率 < 0.1%。
4. **安全目标**：严格最小权限原则；不收集、传输任何个人学习数据。

## 4. 范围

### 4.1 In‑Scope

- 检测课程页面中 DOM 变化，识别暂停播放弹窗。
- 自动触发点击或键盘事件（如 `Space`、`Enter`）以关闭弹窗。
- 可选的随机化点击延迟（100–500 ms）与鼠标轨迹，降低被平台识别风险。
- 用户可自定义：
    - 站点域名白名单 / 黑名单
    - 识别规则（CSS Selector / 文本关键字 / XPath）
    - 随机延迟范围
- 前端弹窗通知插件当前状态（检测到弹窗并已自动点击、失败重试等）。

### 4.2 Out‑of‑Scope

- 绕过视频倍速或广告限制。
- 自动填写考试/测验答案。
- 移动端浏览器支持。

## 5. 用户画像 & 用户故事

| Persona | 角色 | 需求痛点 | 关键指标 |
| --- | --- | --- | --- |
| Jack（大学生） | 需要刷网课获得学分 | 夜间复习时经常离开键盘做笔记，弹窗打断思路 | 成功自动点击率 100% |
| Lisa（企业 HR） | 负责员工合规培训 | 批量播放培训课程，需无人值守 | 单次课程完成率提升 50% |
| Kevin（自由职业者） | 学习新技能视频课程 | 在两台显示器间切换工作，频繁失焦导致暂停 | 学习时长连续性 |

**示例用户故事**

> 作为 Jack，当我在 学习新干线网站 https://learning.hzrs.hangzhou.gov.cn/#/ 课堂页面复习并离开键盘 20 分钟时，我希望插件能自动点击“继续观看”按钮，以便视频不中断。
> 

## 6. 功能需求

### 6.1 弹窗检测

- **F‑1**：监听指定 DOM 节点变化（MutationObserver）或定时扫描，判断页面是否出现符合规则的弹窗元素。
- **F‑2**：支持多规则匹配，优先级可配置。
- **F‑3**：在检测到弹窗后，立即进入自动交互流程。

### 6.2 自动交互

- **F‑4**：根据规则中定义的按钮 Selector，触发 `click()` 事件；若未指定，默认对焦并发送 `Enter` 键事件。
- **F‑5**：支持可选的人为操作仿真：
    - 随机延迟
    - 随机鼠标轨迹（Bezier 曲线）
    - 随机点击位置（按钮范围内）
- **F‑6**：若首次点击失败，重试最多 3 次，间隔递增。

### 6.3 规则管理

- **F‑7**：插件弹窗提供站点规则列表，包含：站点域名、弹窗 Selector、按钮 Selector、是否启用。
- **F‑8**：导入 / 导出 JSON 规则文件。
- **F‑9**：一键开启“通用模式”（基于常见关键词如“仍在观看”）快速匹配。

### 6.4 状态反馈

- **F‑10**：浏览器工具栏图标显示三态：正常运行 / 发现弹窗已点击 / 错误。
- **F‑11**：控制台日志记录检测与点击事件（供调试）。

### 6.5 设置

- **F‑12**：开关随机化、人为操作仿真。
- **F‑13**：黑暗 / 浅色主题切换。

## **6.6 交互时效性**

### **6.6.1 弹窗时效性要求**

- 插件需在弹窗出现后的 20 分钟内保持监听，当弹窗出现时，系统需要在 2 分钟内自动完成点击操作。
- 如果 2 分钟内没有检测到用户的有效操作，弹窗会停止并暂停课程，插件需确保自动点击操作尽量在 30 秒内完成。
- 插件应支持自定义弹窗弹出与点击操作的最大延迟，默认设置为 30 秒。

## 7. 非功能需求

| 类别 | 描述 |
| --- | --- |
| **性能** | 检测循环 CPU 占用 < 2%；内存占用 < 50 MB |
| **安全** | 仅申请 `activeTab`, `scripting`, `storage` 权限；不访问跨域资源 |
| **可用性** | UI 支持中英文；首次安装引导 < 3 步完成规则导入 |
| **可维护性** | 代码按功能模块拆分；80% 单元测试覆盖率 |
| **合规** | 遵守 Chrome Web Store 政策；不开启远程代码执行 |

## 8. 关键指标（KPI）

1. 自动点击成功率 ≥ 99%
2. 用户月活留存率 ≥ 60%
3. 平均 CPU 占用 ≤ 1.5%
4. 错误报告/安装量 ≤ 1%

## 9. 竞争分析

| 产品 | 功能覆盖 | 隐私合规 | 开源 | 备注 |
| --- | --- | --- | --- | --- |
| StayOn | 仅检测 YouTube | ✅ | ❌ | 无规则编辑 |
| Video Autoplay | 多站点 | ❓ | ✅ | 无随机化点击 |
| **AutoContinue** | **多站点+规则+随机化** | **✅** | **✅** | **差异化** |

## 10. 技术方案

### 10.1 架构

```
Manifest v3
├── background service worker (持久监听, 注入 content script)
├── content script (站点 DOM 监听 + 自动点击)
└── options UI (规则管理 React + Tailwind)

```

### 10.2 关键技术点

- **DOM 监听**：使用 `MutationObserver`，降频至 500 ms，避免性能问题。
- **脚本注入**：`chrome.scripting.executeScript` 动态注入，确保最小权限。
- **鼠标轨迹仿真**：在 content script 内生成随机路径，使用 `dispatchEvent(new MouseEvent(...))` 连续触发 `mousemove`。
- **规则引擎**：基于 JSON Schema，支持通配符与正则。

### 10.3 第三方库

- `lodash`（节流、防抖）
- `react` + `vite` 构建 Options 页面
- `uuid`（生成规则 ID）

## 11. 风险 & 缓解

| 风险 | 等级 | 缓解措施 |
| --- | --- | --- |
| 平台更新导致 Selector 失效 | 高 | 规则在线更新 + 社区分享 |
| 被平台检测为自动化操作 | 中 | 随机化点击、延迟、人类轨迹仿真 |
| 插件被 Chrome 商店下架 | 中 | 严格遵守政策，提供源代码审核 |
| 性能开销过大 | 低 | 节流监听、配置检测间隔 |

## 12. 里程碑 & 资源

| 阶段 | 时间 | 产出 |
| --- | --- | --- |
| 需求冻结 | 4‑15 | PRD 评审通过 |
| 技术方案 & 原型 | 4‑22 | 原型 & 架构评审 |
| 开发 Sprint 1 | 4‑23 ~ 5‑07 | 基础检测 + 自动点击 |
| 开发 Sprint 2 | 5‑08 ~ 5‑22 | 规则编辑器 + UI |
| Beta 测试 | 5‑23 ~ 5‑30 | 反馈收集 & 修复 |
| 发布 | 6‑01 | Chrome Web Store 上线 |

## 13. 验收标准

1. 在指定测试站点，弹窗出现后 ≤1 s 自动点击且视频继续播放。
2. 在非白名单站点不执行任何自动化操作。
3. 手动关闭插件后，页面无脚本残留。
4. 通过 Chrome Web Store 审核并可正常下载安装。

## 14. 未来展望

- 支持移动端 Kiwi 浏览器。
- AI 视觉识别弹窗，无需 Selector。
- 与学习管理系统（LMS）API 集成，自动记录学习进度。

---

> 备注：本 PRD 仅涵盖 v1.0 MVP 范围，后续功能迭代将根据用户反馈与市场需求另行补充。
>